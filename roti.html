<!doctype html>

<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Roti</title>
	<link rel="stylesheet" href="font-awesome-4.6.3/css/font-awesome.min.css">
	<meta name="description" content="La rotisserie en ligne">
	<meta name="author" content="Des gens roti">
	<link href='https://fonts.googleapis.com/css?family=Noto+Sans:400,700' rel='stylesheet' type='text/css'>

	<!--Import Google Icon Font-->
     <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
     <!--Import materialize.css-->
     <link type="text/css" rel="stylesheet" href="materialize/css/materialize.min.css"  media="screen,projection"/>

     <!--Let browser know website is optimized for mobile-->
     <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

	<link rel="stylesheet" href="roti.css">
	


  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>

	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="materialize/js/materialize.min.js"></script>

	<div class="container">
		<div class="center-block">
			<div class="flip-container" onclick='turn()';>
				<div class="flipper" id="flip">
					<div class="front" id="front">
						<div class="card suitspin"'>
							<p> Chaqu'un énumère un mort de Game Of Thrones. Celui qui ne sait plus boit <i class="fa fa-beer" aria-hidden="true"></i>
								<i class="fa fa-beer" aria-hidden="true"></i>.
				   			</p>
						</div>
					</div>

					<div class="back" id="back">
						<div class="card suitquestion">
							<p> Ceux qui font des retours à la ligne avant d'ouvrir des acollades boivent 
								<i class="fa fa-beer" aria-hidden="true"></i><i class="fa fa-beer" aria-hidden="true"></i><i class="fa fa-beer" aria-hidden="true"></i>.
				   			</p>
						</div>
					</div>


				</div>
			</div>
		</div>	

		<div class="center-item">
			<a class="waves-effect waves-light btn" onclick='turn();'>Roti-moi ! </a>
		</div>

	</div>

	<script type="text/javascript">
	var count = 1;
	var block = false;

	var json = [];
	var total_cards = [];
	var deck = [];


	// Charger le fichier de cartes 
	// TODO : Chargher le nom du fichier à partir de la bare d'adresse
	 $.getJSON("template.json", function(data)
	 	{
	 		json = data;
	 		total_cards = json.cards;

	 	});

		function turn(){

			// Attentre que block soit dispo (pour eviter de tourner plusieurs cartes en même temps)
			if (!block)
			{
				block = true;

				// Faire tourner la carte
			  $("#flip").addClass('rotate');


			  // Attendre la fin de l'animation
			  $("#flip").one('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend',   
			  function(e) {

			  	// Copier la carte au back sur le front
			  	$("#front").html($("#back").html());

				// Enlever la rotation (la carte front repasse devant)
			  	$("#flip").removeClass('rotate');

			  	// Si le deck est vide, le recharger
			  	if (deck.length == 0)
			  	{
			  		deck = total_cards.slice();
			  	}

			  	// Charger ici le back de la prochaine carte à jouer (back)
			  	var id = Math.floor((Math.random() * (deck.length)));

			  	// Enlever les classe de la carte du back pour pouvoir les recharger en fonction de ce qu'il y a dans le json
			  	$("#back .card").removeClass().addClass("card");

			  	// Si la carte à un type, le charger
			  	if (deck[id].type)
			  	{
			  		$("#back .card").addClass("suit"+deck[id].type);
			  	}
			  	$("#back .card p ").html(deck[id].content);

			  	// Enlever la carte du deck
			  	deck.splice(id,1);

			  	block = false;
				});
			}


		};

	</script>

</body>



</html>